{"version":3,"file":"index.js","sources":["../src/components/ChatWidget.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { IconBolt, IconFile, IconSend, IconX } from \"@tabler/icons-react\";\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\n\r\n// Reusable BlockFace component\r\nconst BlockFace = ({ body, eyes, size, isThinking = false }) => {\r\n  const getBodySize = () => size;\r\n  const getEyeSize = () => Math.round(size / 4.5);\r\n\r\n  return (\r\n    <motion.div\r\n      className=\"relative rounded-[0.3rem] flex justify-center items-center\"\r\n      style={{\r\n        backgroundColor: body,\r\n        width: getBodySize(),\r\n        height: getBodySize(),\r\n      }}\r\n      animate={isThinking ? { scale: [1, 0.9, 1] } : {}}\r\n      transition={isThinking ? { repeat: Infinity, duration: 1 } : {}}\r\n    >\r\n      {/* Eyes */}\r\n      <div className=\"absolute top-1/4 flex justify-between w-3/5\">\r\n        <div\r\n          className=\"rounded-sm\"\r\n          style={{\r\n            width: getEyeSize(),\r\n            height: getEyeSize(),\r\n            backgroundColor: eyes,\r\n          }}\r\n        ></div>\r\n        <div\r\n          className=\"rounded-sm\"\r\n          style={{\r\n            width: getEyeSize(),\r\n            height: getEyeSize(),\r\n            backgroundColor: eyes,\r\n          }}\r\n        ></div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\n// ChatWidget component that can be imported by other components\r\nconst ChatWidget = ({\r\n  apiKey,\r\n  contextParams = {},\r\n  widgetPosition = \"bottom-[8px] md:bottom-[24px] right-[8px] md:right-[24px]\",\r\n  chatPosition = \"bottom-[0px] right-[0px]\",\r\n}) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [widgetLoading, setWidgetLoading] = useState(true);\r\n  const [loadingStep, setLoadingStep] = useState(0);\r\n  const [error, setError] = useState(null);\r\n  const [frontend, setFrontend] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [inputMessage, setInputMessage] = useState(\"\");\r\n  const [isWinking, setIsWinking] = useState(false);\r\n  const textAreaRef = useRef(null);\r\n\r\n  const [valid, setValid] = useState(true);\r\n\r\n  const [activeOption, setActiveOption] = useState(\"Find Page\");\r\n\r\n  // Loading states for animation\r\n  const loadingStates = [\r\n    \"Analyzing prompt...\",\r\n    \"Finding best endpoint to hit...\",\r\n    \"Preparing to send data...\",\r\n    \"Sending data...\",\r\n    \"Successfully sent...\",\r\n  ];\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setWidgetLoading(true);\r\n\r\n        if (!apiKey) {\r\n          setError(\"API key not found\");\r\n          return;\r\n        }\r\n\r\n        // Fetch frontend details\r\n        const frontendResponse = await fetch(\r\n          \"https://limeblockbackend.onrender.com/api/public_frontend_details/\",\r\n          {\r\n            method: \"POST\",\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({ api_key: apiKey }),\r\n          }\r\n        );\r\n\r\n        const checkValid = await fetch(\r\n          \"https://limeblockbackend.onrender.com/api/are_maus_remaining/\",\r\n          {\r\n            method: \"POST\",\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({ api_key: apiKey }),\r\n          }\r\n        );\r\n\r\n        const frontendData = await frontendResponse.json();\r\n        const validData = await checkValid.json();\r\n\r\n        if (frontendData.success) {\r\n          setFrontend(frontendData.frontend);\r\n        } else {\r\n          setError(\"Failed to load frontend settings\");\r\n        }\r\n\r\n        setValid(validData.valid);\r\n      } catch (error) {\r\n        console.error(\"Error fetching data:\", error);\r\n        setError(\"Network error, please try again\");\r\n      } finally {\r\n        setLoading(false);\r\n        setWidgetLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [apiKey]);\r\n\r\n  // Set up the loading animation cycle\r\n  useEffect(() => {\r\n    let interval;\r\n    if (loading) {\r\n      interval = setInterval(() => {\r\n        setLoadingStep((prev) => (prev + 1) % loadingStates.length);\r\n      }, 5000);\r\n    }\r\n    return () => clearInterval(interval);\r\n  }, [loading]);\r\n\r\n  // Auto-resize text area based on content\r\n  useEffect(() => {\r\n    if (textAreaRef.current) {\r\n      const textarea = textAreaRef.current;\r\n      // Reset height to auto to get the correct scrollHeight\r\n      textarea.style.height = \"auto\";\r\n      // Set new height based on scrollHeight, but cap at 50% of chat container\r\n      const maxHeight = 500 * 0.5; // 50% of the 500px chat container height\r\n      const newHeight = Math.min(textarea.scrollHeight, maxHeight);\r\n      textarea.style.height = `${newHeight}px`;\r\n    }\r\n  }, [inputMessage]);\r\n\r\n  const toggleChat = () => {\r\n    setIsOpen(!isOpen);\r\n  };\r\n\r\n  // Function to generate a unique fingerprint\r\n  function generateFingerprint() {\r\n    // Combine various browser properties to create a unique identifier\r\n    const components = [\r\n      navigator.userAgent,\r\n      navigator.language,\r\n      `${window.screen.width}x${window.screen.height}`,\r\n      new Date().getTimezoneOffset(),\r\n      !!window.sessionStorage,\r\n      !!window.localStorage,\r\n      !!window.indexedDB,\r\n      navigator.hardwareConcurrency || \"\",\r\n      navigator.deviceMemory || \"\",\r\n    ];\r\n\r\n    // Simple hash function\r\n    return components\r\n      .join(\"|\")\r\n      .split(\"\")\r\n      .reduce((a, b) => {\r\n        a = (a << 5) - a + b.charCodeAt(0);\r\n        return a & a;\r\n      }, 0)\r\n      .toString(36);\r\n  }\r\n\r\n  const handleSendMessage = async (e) => {\r\n    e.preventDefault();\r\n    if (inputMessage.trim()) {\r\n      // Add user message to chat\r\n      setMessages([...messages, { text: inputMessage, sender: \"user\" }]);\r\n\r\n      // Reset textarea height\r\n      if (textAreaRef.current) {\r\n        textAreaRef.current.style.height = \"auto\";\r\n      }\r\n\r\n      if (!valid) {\r\n        setMessages((prev) => [\r\n          ...prev,\r\n          { text: \"This company has run out of MAUs\", sender: \"bot\" },\r\n        ]);\r\n        return;\r\n      }\r\n\r\n      // Show loading indicator\r\n      setLoading(true);\r\n      setLoadingStep(0);\r\n\r\n      try {\r\n        // Send message to Django backend\r\n        const response = await fetch(\r\n          \"https://limeblockbackend.onrender.com/api/process_prompt/\",\r\n          {\r\n            method: \"POST\",\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({\r\n              prompt: inputMessage,\r\n              api_key: apiKey,\r\n              context: contextParams,\r\n              option: activeOption,\r\n              client_info: {\r\n                // Add unique identifier for the client\r\n                fingerprint: generateFingerprint(),\r\n                referrer: document.referrer || null,\r\n                hostname: window.location.hostname,\r\n                pathname: window.location.pathname,\r\n                user_agent: navigator.userAgent,\r\n                language: navigator.language,\r\n                screen_resolution: `${window.screen.width}x${window.screen.height}`,\r\n                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\r\n              },\r\n            }),\r\n          }\r\n        );\r\n\r\n        const data = await response.json();\r\n        console.log(\"Response data:\", JSON.stringify(data, null, 2));\r\n\r\n        // Add bot response to chat\r\n        if (response.ok) {\r\n          // If the request was successful\r\n          let responseText;\r\n\r\n          responseText = data.formatted_response;\r\n          if (data.endpoint_type == \"frontend\") {\r\n            setMessages((prev) => [\r\n              ...prev,\r\n              { text: responseText, sender: \"bot\", link: data.url },\r\n            ]);\r\n          } else if (data.endpoint_type == \"backend\") {\r\n            setMessages((prev) => [\r\n              ...prev,\r\n              {\r\n                text: responseText,\r\n                sender: \"bot\",\r\n                confirm_data: {\r\n                  endpoint: data.endpoint,\r\n                  schema: data.schema,\r\n                  prompt: data.prompt,\r\n                },\r\n              },\r\n            ]);\r\n          } else {\r\n            setMessages((prev) => [\r\n              ...prev,\r\n              { text: responseText, sender: \"bot\" },\r\n            ]);\r\n          }\r\n        } else {\r\n          // Handle error response\r\n          const errorMessage =\r\n            data.error || data.message || \"Something went wrong\";\r\n          setMessages((prev) => [\r\n            ...prev,\r\n            {\r\n              text: `Error: ${errorMessage}`,\r\n              sender: \"bot\",\r\n            },\r\n          ]);\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error sending message:\", error);\r\n        setMessages((prev) => [\r\n          ...prev,\r\n          {\r\n            text: \"Sorry, there was a network error. Please try again later.\",\r\n            sender: \"bot\",\r\n          },\r\n        ]);\r\n      } finally {\r\n        setLoading(false);\r\n        setInputMessage(\"\");\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleConfirmBackendAction = async (action_data) => {\r\n    if (textAreaRef.current) {\r\n      textAreaRef.current.style.height = \"auto\";\r\n    }\r\n\r\n    // Show loading indicator\r\n    setLoading(true);\r\n    setLoadingStep(0);\r\n\r\n    try {\r\n      // Send message to Django backend\r\n      const response = await fetch(\r\n        \"https://limeblockbackend.onrender.com/api/commit_backend_action/\",\r\n        {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify({\r\n            prompt: action_data.prompt,\r\n            api_key: apiKey,\r\n            endpoint: action_data.endpoint,\r\n            schema: action_data.schema,\r\n          }),\r\n        }\r\n      );\r\n\r\n      const data = await response.json();\r\n      // Add bot response to chat\r\n      if (response.ok) {\r\n        // If the request was successful\r\n        let responseText;\r\n\r\n        responseText = data.formatted_response;\r\n\r\n        setMessages((prev) => [...prev, { text: responseText, sender: \"bot\" }]);\r\n      } else {\r\n        // Handle error response\r\n        const errorMessage =\r\n          data.error || data.message || \"Something went wrong\";\r\n        setMessages((prev) => [\r\n          ...prev,\r\n          {\r\n            text: `Error: ${errorMessage}`,\r\n            sender: \"bot\",\r\n          },\r\n        ]);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error sending message:\", error);\r\n      setMessages((prev) => [\r\n        ...prev,\r\n        {\r\n          text: \"Sorry, there was a network error. Please try again later.\",\r\n          sender: \"bot\",\r\n        },\r\n      ]);\r\n    } finally {\r\n      setLoading(false);\r\n      setInputMessage(\"\");\r\n    }\r\n  };\r\n\r\n  // Handle winking during shake\r\n  const handleShake = () => {\r\n    setIsWinking(true);\r\n    // Reset winking after shake animation completes\r\n    setTimeout(() => setIsWinking(false), 500);\r\n  };\r\n\r\n  // Calculate sizes based on frontend.size\r\n  const getBodySize = () => {\r\n    if (!frontend?.size) return 44; // Default size if not provided\r\n    return frontend.size * 5;\r\n  };\r\n\r\n  const getEyeSize = () => {\r\n    if (!frontend?.size) return 9; // Default size if not provided\r\n    return Math.round((frontend.size * 5) / 5);\r\n  };\r\n\r\n  // Animation variants\r\n  const buttonVariants = {\r\n    initial: { scale: 0, opacity: 0 },\r\n    animate: {\r\n      scale: 1,\r\n      opacity: 1,\r\n      transition: { type: \"spring\", stiffness: 260, damping: 20 },\r\n    },\r\n    hover: {\r\n      scale: 1.1,\r\n      boxShadow: \"0px 5px 15px rgba(0, 0, 0, 0.1)\",\r\n      transition: { type: \"spring\", stiffness: 400, damping: 10 },\r\n    },\r\n    tap: { scale: 0.95 },\r\n  };\r\n\r\n  const chatPanelVariants = {\r\n    hidden: {\r\n      opacity: 0,\r\n      y: 20,\r\n      scale: 0.95,\r\n      transformOrigin: \"bottom right\",\r\n    },\r\n    visible: {\r\n      opacity: 1,\r\n      y: 0,\r\n      scale: 1,\r\n      transition: {\r\n        type: \"spring\",\r\n        stiffness: 300,\r\n        damping: 24,\r\n      },\r\n    },\r\n    exit: {\r\n      opacity: 0,\r\n      y: 20,\r\n      scale: 0.95,\r\n      transition: { duration: 0.2 },\r\n    },\r\n  };\r\n\r\n  const eyeVariants = {\r\n    initial: { opacity: 0, y: 5 },\r\n    animate: {\r\n      opacity: 1,\r\n      y: 0,\r\n      transition: { delay: 0.2, duration: 0.3 },\r\n    },\r\n  };\r\n\r\n  const messageVariants = {\r\n    initial: { opacity: 0, y: 10 },\r\n    animate: {\r\n      opacity: 1,\r\n      y: 0,\r\n      transition: { type: \"spring\", stiffness: 500, damping: 25 },\r\n    },\r\n  };\r\n\r\n  // Styles for portal container\r\n  const portalStyle = {\r\n    position: \"fixed\",\r\n    zIndex: 9999,\r\n    pointerEvents: \"none\", // Makes the container not interfere with other elements\r\n  };\r\n\r\n  // Styles for elements that need pointer events\r\n  const interactiveStyle = {\r\n    pointerEvents: \"auto\", // Re-enables pointer events for chat elements\r\n  };\r\n\r\n  if (widgetLoading) {\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    // Portal container - fixed position, doesn't affect page layout\r\n    <div style={portalStyle} className={`w-fit h-fit ${widgetPosition}`}>\r\n      <AnimatePresence mode=\"wait\">\r\n        {!isOpen ? (\r\n          <motion.button\r\n            onClick={toggleChat}\r\n            key=\"chat-button\"\r\n            initial=\"initial\"\r\n            animate=\"animate\"\r\n            whileHover=\"hover\"\r\n            whileTap=\"tap\"\r\n            variants={buttonVariants}\r\n            className=\"rounded-md overflow-hidden shadow-md\"\r\n            style={interactiveStyle}\r\n          >\r\n            <motion.div\r\n              style={{\r\n                backgroundColor: frontend?.body || \"#90F08C\",\r\n                width: `${getBodySize()}px`,\r\n                height: `${getBodySize()}px`,\r\n              }}\r\n              className=\"rounded-md flex justify-evenly items-center\"\r\n              whileHover={{\r\n                rotate: [0, -5, 5, -5, 0],\r\n                transition: { duration: 0.5 },\r\n              }}\r\n              onHoverStart={handleShake}\r\n            >\r\n              {/* Left Eye */}\r\n              <motion.div\r\n                style={{\r\n                  backgroundColor: frontend?.eyes || \"#FFFFFF\",\r\n                  width: `${getEyeSize()}px`,\r\n                  height: `${getEyeSize()}px`,\r\n                }}\r\n                className=\"rounded-sm mb-[0.625rem]\"\r\n                variants={eyeVariants}\r\n                animate={isWinking ? { scaleY: 0.1 } : { scaleY: 1 }}\r\n                initial={{ scaleY: 1 }}\r\n                whileHover={{ scale: 1.02 }}\r\n                transition={{ duration: 0.2 }}\r\n              ></motion.div>\r\n\r\n              {/* Right Eye */}\r\n              <motion.div\r\n                style={{\r\n                  backgroundColor: frontend?.eyes || \"#FFFFFF\",\r\n                  width: `${getEyeSize()}px`,\r\n                  height: `${getEyeSize()}px`,\r\n                }}\r\n                className=\"rounded-sm mb-[0.625rem]\"\r\n                variants={eyeVariants}\r\n                whileHover={{ scale: 1.02 }}\r\n                transition={{ duration: 0.2 }}\r\n              ></motion.div>\r\n            </motion.div>\r\n          </motion.button>\r\n        ) : (\r\n          <motion.div\r\n            key=\"chat-panel\"\r\n            variants={chatPanelVariants}\r\n            initial=\"hidden\"\r\n            animate=\"visible\"\r\n            exit=\"exit\"\r\n            className={`rounded-xl w-[330px] md:w-[390px] h-[460px] md:h-[500px] shadow-2xl flex flex-col overflow-hidden font-inter ${chatPosition}`}\r\n            style={{\r\n              ...interactiveStyle,\r\n              position: \"absolute\",\r\n              backgroundColor: frontend?.pageBackground || \"#FFFFFF\",\r\n            }}\r\n          >\r\n            {/* Chat Header */}\r\n            <motion.div\r\n              className=\"px-4 py-4 flex justify-between items-center\"\r\n              style={{ backgroundColor: frontend?.banner || \"#90F08C\" }}\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              transition={{ delay: 0.1 }}\r\n            >\r\n              <div className=\"flex flex-row space-x-3 items-center\">\r\n                <div\r\n                  style={{ borderColor: frontend?.eyes || \"\" }}\r\n                  className=\"border rounded-lg\"\r\n                >\r\n                  <BlockFace\r\n                    body={frontend?.body}\r\n                    eyes={frontend?.eyes}\r\n                    size={36}\r\n                    isThinking={false}\r\n                  />\r\n                </div>\r\n\r\n                <motion.span\r\n                  className=\"ml-2 text-base text-black font-inter font-normal\"\r\n                  initial={{ opacity: 0, x: -20 }}\r\n                  animate={{ opacity: 1, x: 0 }}\r\n                  transition={{ delay: 0.2, type: \"spring\" }}\r\n                >\r\n                  {frontend?.pageTitle || \"Chat Assistant\"}\r\n                </motion.span>\r\n              </div>\r\n\r\n              <motion.button\r\n                onClick={toggleChat}\r\n                className=\"text-gray-800 hover:text-black mr-2\"\r\n                whileHover={{ scale: 1.1 }}\r\n                whileTap={{ scale: 0.9 }}\r\n              >\r\n                <IconX className=\"size-5\" />\r\n              </motion.button>\r\n            </motion.div>\r\n            <div\r\n              className=\"w-5/6 mx-auto h-[1px]\"\r\n              style={{\r\n                backgroundColor: frontend?.banner == \"#FFFFFF\" ? \"#E5E7EB\" : \"\",\r\n              }}\r\n            ></div>\r\n\r\n            {/* Chat Messages */}\r\n            <motion.div\r\n              className=\"flex-grow overflow-y-auto overflow-x-hidden scroll-pe-0 bg-white pb-4 px-4 py-4\"\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              transition={{ delay: 0.2 }}\r\n            >\r\n              {loading && messages.length === 0 ? (\r\n                <div className=\"flex justify-center items-center h-full\">\r\n                  <motion.div\r\n                    animate={{\r\n                      rotate: 360,\r\n                      transition: {\r\n                        repeat: Infinity,\r\n                        duration: 1,\r\n                        ease: \"linear\",\r\n                      },\r\n                    }}\r\n                    className=\"w-6 h-6 border-2 border-gray-300 border-t-gray-600 rounded-full\"\r\n                  ></motion.div>\r\n                </div>\r\n              ) : error ? (\r\n                <motion.div\r\n                  className=\"text-red-500 text-center p-4\"\r\n                  initial={{ opacity: 0, y: 10 }}\r\n                  animate={{ opacity: 1, y: 0 }}\r\n                >\r\n                  {error}\r\n                </motion.div>\r\n              ) : (\r\n                <>\r\n                  {messages.length === 0 ? (\r\n                    <motion.div\r\n                      className=\"text-gray-500 text-center mt-4\"\r\n                      initial={{ opacity: 0, y: 10 }}\r\n                      animate={{ opacity: 1, y: 0 }}\r\n                      transition={{ delay: 0.3 }}\r\n                    >\r\n                      {valid\r\n                        ? frontend?.startText || \"How can I help you today?\"\r\n                        : \"This company has run out of MAUs\"}\r\n                    </motion.div>\r\n                  ) : (\r\n                    <AnimatePresence>\r\n                      {messages.map((msg, index) => (\r\n                        <motion.div\r\n                          key={index}\r\n                          className={`mb-4 flex gap-3 h-fit ${\r\n                            msg.sender === \"user\"\r\n                              ? \"flex-row w-11/12 ml-auto\"\r\n                              : \"flex-row\"\r\n                          }`}\r\n                          variants={messageVariants}\r\n                          initial=\"initial\"\r\n                          animate=\"animate\"\r\n                          transition={{ delay: index * 0.05 }}\r\n                        >\r\n                          {msg.sender === \"user\" ? (\r\n                            <></>\r\n                          ) : (\r\n                            <div className=\"flex mt-auto\">\r\n                              <BlockFace\r\n                                body={frontend?.body}\r\n                                eyes={frontend?.eyes}\r\n                                size={36}\r\n                                isThinking={false}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          <motion.div\r\n                            className={`inline-block rounded-lg text-center px-4 py-4 relative group ${\r\n                              msg.sender === \"user\"\r\n                                ? \"ml-auto text-[0.9rem] w-fit\"\r\n                                : \"text-[0.9rem] max-w-11/12\"\r\n                            }`}\r\n                            whileHover={{ scale: 1.02 }}\r\n                            style={{\r\n                              backgroundColor:\r\n                                msg.sender == \"user\"\r\n                                  ? frontend?.userMessageBackground || \"#E5E7EB\"\r\n                                  : frontend?.aiMessageBackground || \"#F3F4F6\",\r\n                              whiteSpace: \"pre-wrap\",\r\n                              textAlign: \"left\",\r\n                              color:\r\n                                msg.sender == \"user\"\r\n                                  ? frontend?.userText || \"#000000\"\r\n                                  : frontend?.aiText || \"#111111\",\r\n                            }}\r\n                          >\r\n                            {msg.text}\r\n                            <br />\r\n                            {msg.link ? (\r\n                              <button\r\n                                className=\"bg-gray-900 px-3 py-2 mt-2 text-white font-inter text-xs rounded-md\"\r\n                                onClick={() => {\r\n                                  window.open(msg.link);\r\n                                }}\r\n                              >\r\n                                Visit Page\r\n                              </button>\r\n                            ) : (\r\n                              <></>\r\n                            )}\r\n\r\n                            {msg.confirm_data ? (\r\n                              <button\r\n                                className=\"bg-gray-900 px-3 py-2 mt-2 text-white font-inter text-xs rounded-md\"\r\n                                onClick={() => {\r\n                                  handleConfirmBackendAction(msg.confirm_data);\r\n                                }}\r\n                              >\r\n                                Confirm Action\r\n                              </button>\r\n                            ) : (\r\n                              <></>\r\n                            )}\r\n                          </motion.div>\r\n                        </motion.div>\r\n                      ))}\r\n                    </AnimatePresence>\r\n                  )}\r\n                </>\r\n              )}\r\n\r\n              {/* AI Thinking/Loading Indicator */}\r\n              {loading && messages.length > 0 && (\r\n                <motion.div\r\n                  className=\"flex items-center mb-4\"\r\n                  initial={{ opacity: 0 }}\r\n                  animate={{ opacity: 1 }}\r\n                >\r\n                  <BlockFace\r\n                    body={frontend?.body}\r\n                    eyes={frontend?.eyes}\r\n                    size={36}\r\n                    isThinking={true}\r\n                  />\r\n                  <motion.div\r\n                    className=\"rounded-lg px-4 py-2 text-sm ml-2\"\r\n                    key={loadingStep}\r\n                    initial={{ opacity: 0, y: 10 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    exit={{ opacity: 0 }}\r\n                    style={{\r\n                      backgroundColor:\r\n                        frontend?.aiMessageBackground || \"#F3F4F6\",\r\n                      color: frontend?.aiText || \"#111111\",\r\n                    }}\r\n                  >\r\n                    {loadingStates[loadingStep]}\r\n                  </motion.div>\r\n                </motion.div>\r\n              )}\r\n            </motion.div>\r\n\r\n            {/* Chat Input */}\r\n            <motion.form\r\n              onSubmit={handleSendMessage}\r\n              className=\"px-4 pt-2\"\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ delay: 0.3 }}\r\n            >\r\n              <div className=\"flex border border-gray-300 px-2 rounded-md flex-col\">\r\n                <motion.textarea\r\n                  ref={textAreaRef}\r\n                  value={inputMessage}\r\n                  onChange={(e) => setInputMessage(e.target.value)}\r\n                  placeholder=\"Type a message...\"\r\n                  className=\"resize-none flex-grow text-sm pr-5 pt-3 pb-4 outline-none ring-0 focus:ring-0 focus:outline-none active:ring-0 active:outline-none\"\r\n                  style={{\r\n                    minHeight: \"40px\",\r\n                    maxHeight: \"250px\", // 50% of the 500px container\r\n                    overflow: \"auto\",\r\n                    backgroundColor: frontend?.pageBackground || \"#FFFFFF\",\r\n                  }}\r\n                  disabled={loading}\r\n                  onKeyDown={(e) => {\r\n                    if (e.key === \"Enter\" && !e.shiftKey) {\r\n                      e.preventDefault();\r\n                      handleSendMessage(e);\r\n                    }\r\n                  }}\r\n                />\r\n                <div className=\"flex flex-row justify-between items-end h-fit w-full -mt-1 md:-mt-4\">\r\n                  <div className=\"flex flex-row gap-2 h-full pb-3\">\r\n                    <motion.button\r\n                      type=\"button\"\r\n                      className={`px-3 py-1 flex flex-row items-center text-xs font-inter rounded-full text-gray-700 ${\r\n                        activeOption === \"Find Page\"\r\n                          ? \"border border-gray-400\"\r\n                          : \"bg-gray-200\"\r\n                      }`}\r\n                      style={{\r\n                        backgroundColor: frontend?.pageBackground || \"#FFFFFF\",\r\n                      }}\r\n                      onClick={() => setActiveOption(\"Find Page\")}\r\n                      whileHover={{ scale: 1.02 }}\r\n                      whileTap={{ scale: 0.97 }}\r\n                    >\r\n                      <IconFile className=\"size-4 mr-1\" />\r\n                      Find Page\r\n                    </motion.button>\r\n                    <motion.button\r\n                      type=\"button\"\r\n                      className={`px-3 py-1 flex flex-row items-center text-xs font-inter rounded-full text-gray-700 ${\r\n                        activeOption === \"Do Action\"\r\n                          ? \"border border-gray-400\"\r\n                          : \"bg-gray-200\"\r\n                      }`}\r\n                      style={{\r\n                        backgroundColor: frontend?.pageBackground || \"#FFFFFF\",\r\n                      }}\r\n                      onClick={() => setActiveOption(\"Do Action\")}\r\n                      whileHover={{ scale: 1.02 }}\r\n                      whileTap={{ scale: 0.97 }}\r\n                    >\r\n                      <IconBolt className=\"size-4 mr-1\" />\r\n                      Do Action\r\n                    </motion.button>\r\n                  </div>\r\n                  <motion.button\r\n                    type=\"submit\"\r\n                    className=\"size-10 mt-auto place-items-bottom mb-2 rounded-lg text-white flex justify-center items-center\"\r\n                    style={{ backgroundColor: frontend?.body || \"#90F08C\" }}\r\n                    whileHover={{ scale: 1.05 }}\r\n                    whileTap={{ scale: 0.95 }}\r\n                    disabled={loading}\r\n                  >\r\n                    {loading ? (\r\n                      <motion.div\r\n                        animate={{\r\n                          rotate: 360,\r\n                          transition: {\r\n                            repeat: Infinity,\r\n                            duration: 1,\r\n                            ease: \"linear\",\r\n                          },\r\n                        }}\r\n                        className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full\"\r\n                      ></motion.div>\r\n                    ) : (\r\n                      <IconSend className=\"size-6\" />\r\n                    )}\r\n                  </motion.button>\r\n                </div>\r\n              </div>\r\n            </motion.form>\r\n            <div className=\"flex flex-row items-center justify-center text-center pb-2 pt-1\">\r\n              <a\r\n                href=\"https://limeblock.io/\"\r\n                className=\"font-inter text-gray-500 hover:underline transition duration-200\"\r\n                style={{ fontSize: \"10px\" }}\r\n              >\r\n                Powered by Limeblock\r\n              </a>\r\n            </div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatWidget;\r\n"],"names":["BlockFace","_ref","body","eyes","size","_ref$isThinking","isThinking","getBodySize","getEyeSize","Math","round","_jsx","jsx","motion","div","className","style","backgroundColor","width","height","animate","scale","transition","repeat","Infinity","duration","children","_jsxs","jsxs","ChatWidget$1","_ref2","apiKey","_ref2$contextParams","contextParams","_ref2$widgetPosition","widgetPosition","_ref2$chatPosition","chatPosition","_useState2","_slicedToArray","useState","isOpen","setIsOpen","_useState4","loading","setLoading","_useState6","widgetLoading","setWidgetLoading","_useState8","loadingStep","setLoadingStep","_useState10","error","setError","_useState12","frontend","setFrontend","_useState14","messages","setMessages","_useState16","inputMessage","setInputMessage","_useState18","isWinking","setIsWinking","textAreaRef","useRef","_useState20","valid","setValid","_useState22","activeOption","setActiveOption","loadingStates","useEffect","fetchData","_ref3","_asyncToGenerator","_regeneratorRuntime","mark","_callee","frontendResponse","checkValid","frontendData","validData","wrap","_context","prev","next","abrupt","fetch","method","headers","JSON","stringify","api_key","sent","json","success","t0","console","finish","stop","apply","this","arguments","interval","setInterval","length","clearInterval","current","textarea","newHeight","min","scrollHeight","concat","toggleChat","handleSendMessage","_ref4","_callee2","e","response","data","responseText","errorMessage","_context2","preventDefault","trim","_toConsumableArray","text","sender","prompt","context","option","client_info","fingerprint","navigator","userAgent","language","window","screen","Date","getTimezoneOffset","sessionStorage","localStorage","indexedDB","hardwareConcurrency","deviceMemory","join","split","reduce","a","b","charCodeAt","toString","referrer","document","hostname","location","pathname","user_agent","screen_resolution","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","log","ok","formatted_response","endpoint_type","link","url","confirm_data","endpoint","schema","message","_x","handleConfirmBackendAction","_ref5","_callee3","action_data","_context3","_x2","eyeVariants","initial","opacity","y","delay","messageVariants","type","stiffness","damping","interactiveStyle","pointerEvents","_Fragment","position","zIndex","AnimatePresence","mode","variants","hidden","transformOrigin","visible","exit","_objectSpread","pageBackground","banner","borderColor","span","x","pageTitle","button","onClick","whileHover","whileTap","IconX","rotate","ease","startText","map","msg","index","userMessageBackground","aiMessageBackground","whiteSpace","textAlign","color","userText","aiText","open","form","onSubmit","ref","value","onChange","target","placeholder","minHeight","maxHeight","overflow","disabled","onKeyDown","key","shiftKey","IconFile","IconBolt","IconSend","href","fontSize","hover","boxShadow","tap","onHoverStart","setTimeout","scaleY"],"mappings":"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"}